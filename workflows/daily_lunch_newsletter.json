{
  "name": "Daily Lunch Newsletter",
  "description": "ë§¤ì¼ 13ì‹œ(KST)ì— ì£¼ì œë³„ ë‰´ìŠ¤ë¥¼ ìˆ˜ì§‘, Groq AIë¡œ ìš”ì•½í•˜ì—¬ Gmail ë°œì†¡",
  "active": false,
  "settings": {
    "timezone": "Asia/Seoul"
  },
  "nodes": [
    {
      "id": "1",
      "name": "Manual Trigger",
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [50, 300],
      "parameters": {}
    },
    {
      "id": "2",
      "name": "Schedule Trigger",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1,
      "position": [50, 150],
      "parameters": {
        "triggerTimes": {
          "item": [
            {
              "hours": [13],
              "minutes": [0]
            }
          ]
        },
        "timezone": "Asia/Seoul"
      }
    },
    {
      "id": "3",
      "name": "Collect All News",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [300, 220],
      "parameters": {
        "jsCode": "// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n// ì£¼ì œë³„ RSS ìˆ˜ì§‘ ë° íŒŒì‹±\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nconst topics = [\n  { name: 'êµ­ë‚´ì •ì¹˜', url: 'https://rss.donga.com/politics.xml' },\n  { name: 'êµ­ì™¸ì •ì¹˜', url: 'https://rss.donga.com/foreign.xml' },\n  { name: 'í˜¸ì£¼ì´ë¯¼', url: 'https://www.smh.com.au/rss/feed.xml' },\n  { name: 'í˜¸ì£¼',    url: 'https://www.abc.net.au/news/feed/51120/rss.xml' },\n  { name: 'ëŒ€í•œë¯¼êµ­', url: 'https://rss.donga.com/total.xml' },\n  { name: 'AIë°SW',  url: 'https://techcrunch.com/feed/' }\n];\n\n// RSS XMLì—ì„œ ìµœëŒ€ maxItemsê°œ ê¸°ì‚¬ ì¶”ì¶œ\nfunction extractRssItems(xml, maxItems = 5) {\n  const items = [];\n  const itemRegex = /<item[^>]*>([\\s\\S]*?)<\\/item>/gi;\n  let match;\n  while ((match = itemRegex.exec(xml)) !== null && items.length < maxItems) {\n    const block = match[1];\n    // CDATA í¬í•¨ title/description ì¶”ì¶œ\n    const title = (\n      block.match(/<title[^>]*><!\\[CDATA\\[([\\s\\S]*?)\\]\\]><\\/title>/) ||\n      block.match(/<title[^>]*>([\\s\\S]*?)<\\/title>/)\n    )?.[1] || '';\n    const desc = (\n      block.match(/<description[^>]*><!\\[CDATA\\[([\\s\\S]*?)\\]\\]><\\/description>/) ||\n      block.match(/<description[^>]*>([\\s\\S]*?)<\\/description>/)\n    )?.[1] || '';\n    const cleanTitle = title.replace(/<[^>]+>/g, '').trim();\n    const cleanDesc  = desc.replace(/<[^>]+>/g, '').trim().slice(0, 250);\n    if (cleanTitle) items.push(`- ${cleanTitle}\\n  ${cleanDesc}`);\n  }\n  return items;\n}\n\n// í† í”½ë³„ RSS ìˆ˜ì§‘\nconst sections = [];\nfor (const topic of topics) {\n  try {\n    const res = await fetch(topic.url, { headers: { 'User-Agent': 'Mozilla/5.0' } });\n    const xml = await res.text();\n    const items = extractRssItems(xml, 5);\n    sections.push(`## ${topic.name}\\n${items.length > 0 ? items.join('\\n') : 'ìˆ˜ì§‘ëœ ê¸°ì‚¬ ì—†ìŒ'}`);\n  } catch (e) {\n    sections.push(`## ${topic.name}\\nìˆ˜ì§‘ ì‹¤íŒ¨: ${e.message}`);\n  }\n}\n\nconst today = new Date().toLocaleDateString('ko-KR', {\n  year: 'numeric', month: 'long', day: 'numeric', weekday: 'long'\n});\n\nreturn [{ json: { date: today, rawNews: sections.join('\\n\\n') } }];"
      }
    },
    {
      "id": "4",
      "name": "Groq AI ìš”ì•½",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [550, 220],
      "parameters": {
        "jsCode": "// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n// Groq API í˜¸ì¶œ (fetch ì‚¬ìš©)\n// âš ï¸ ì•„ë˜ YOUR_GROQ_API_KEYë¥¼ ì‹¤ì œ í‚¤ë¡œ êµì²´í•˜ì„¸ìš”\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nconst GROQ_API_KEY = 'YOUR_GROQ_API_KEY';\n\nconst rawNews = $input.first().json.rawNews;\nconst date = $input.first().json.date;\n\nconst res = await fetch('https://api.groq.com/openai/v1/chat/completions', {\n  method: 'POST',\n  headers: {\n    'Authorization': `Bearer ${GROQ_API_KEY}`,\n    'Content-Type': 'application/json'\n  },\n  body: JSON.stringify({\n    model: 'llama-3.3-70b-versatile',\n    messages: [\n      {\n        role: 'system',\n        content: 'ë‹¹ì‹ ì€ ì „ë¬¸ ë‰´ìŠ¤ ì—ë””í„°ì…ë‹ˆë‹¤. ì£¼ì–´ì§„ ë‰´ìŠ¤ ê¸°ì‚¬ë“¤ì„ ì£¼ì œë³„ë¡œ ê°„ê²°í•˜ê²Œ ìš”ì•½í•´ì£¼ì„¸ìš”. ê° ì£¼ì œëŠ” 2~3ë¬¸ì¥ìœ¼ë¡œ í•µì‹¬ë§Œ ì •ë¦¬í•˜ê³ , ì ì‹¬ì‹œê°„ì— ì½ê¸° í¸í•œ ë‰´ìŠ¤ë ˆí„° í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”. ì˜ì–´ ê¸°ì‚¬ë„ í•œêµ­ì–´ë¡œ ìš”ì•½í•´ì£¼ì„¸ìš”.'\n      },\n      {\n        role: 'user',\n        content: `ë‹¤ìŒ ë‰´ìŠ¤ë“¤ì„ ì£¼ì œë³„ë¡œ ìš”ì•½í•´ì£¼ì„¸ìš”:\\n\\n${rawNews}`\n      }\n    ],\n    max_tokens: 2000,\n    temperature: 0.3\n  })\n});\n\nconst data = await res.json();\nconst summary = data.choices?.[0]?.message?.content || 'ìš”ì•½ ìƒì„± ì‹¤íŒ¨';\n\nreturn [{ json: { summary, date } }];"
      }
    },
    {
      "id": "5",
      "name": "Build Email HTML",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [800, 220],
      "parameters": {
        "jsCode": "// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n// Groq ì‘ë‹µ íŒŒì‹± + HTML ì´ë©”ì¼ ìƒì„±\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nconst groqResponse = $input.first().json;\nconst summary = groqResponse.choices?.[0]?.message?.content || 'ìš”ì•½ ìƒì„± ì‹¤íŒ¨';\nconst date = $('Collect All News').first().json.date;\n\n// ë§ˆí¬ë‹¤ìš´ ## í—¤ë”ë¥¼ HTML <h2>ë¡œ ë³€í™˜\nconst formattedSummary = summary\n  .replace(/## (.+)/g, '<h2 style=\"color:#1a1a2e;margin-top:24px;\">$1</h2>')\n  .replace(/\\n/g, '<br>');\n\nconst html = `\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <style>\n    body {\n      font-family: -apple-system, 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif;\n      max-width: 680px;\n      margin: 0 auto;\n      background: #f4f4f8;\n      color: #222;\n    }\n    .header {\n      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);\n      color: white;\n      padding: 32px 36px;\n      border-radius: 12px 12px 0 0;\n    }\n    .header h1 { margin: 0; font-size: 24px; font-weight: 700; }\n    .header p  { margin: 8px 0 0; opacity: 0.65; font-size: 13px; }\n    .content {\n      background: white;\n      padding: 28px 36px;\n      border-radius: 0 0 12px 12px;\n      line-height: 1.85;\n      font-size: 14.5px;\n    }\n    .footer {\n      text-align: center;\n      color: #aaa;\n      font-size: 11.5px;\n      padding: 20px;\n    }\n  </style>\n</head>\n<body>\n  <div class=\"header\">\n    <h1>ğŸ—ï¸ ì˜¤ëŠ˜ì˜ ë‰´ìŠ¤ ë¸Œë¦¬í•‘</h1>\n    <p>${date} Â· AI ìš”ì•½ë³¸</p>\n  </div>\n  <div class=\"content\">\n    ${formattedSummary}\n  </div>\n  <div class=\"footer\">\n    ìë™ ë°œì†¡ Â· Daily Lunch Newsletter\n  </div>\n</body>\n</html>\n`;\n\nreturn [{ json: {\n  subject: `ğŸ—ï¸ ì˜¤ëŠ˜ì˜ ë‰´ìŠ¤ ë¸Œë¦¬í•‘ - ${date}`,\n  html,\n  summary\n} }];"
      }
    },
    {
      "id": "6",
      "name": "Gmail ë°œì†¡",
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2,
      "position": [1050, 220],
      "parameters": {
        "operation": "send",
        "sendTo": "YOUR_EMAIL@gmail.com",
        "subject": "={{ $json.subject }}",
        "emailType": "html",
        "message": "={{ $json.html }}",
        "options": {}
      },
      "credentials": {
        "gmailOAuth2": {
          "id": "gmail-oauth",
          "name": "Gmail Account"
        }
      }
    }
  ],
  "connections": {
    "Manual Trigger": {
      "main": [[{ "node": "Collect All News", "type": "main", "index": 0 }]]
    },
    "Schedule Trigger": {
      "main": [[{ "node": "Collect All News", "type": "main", "index": 0 }]]
    },
    "Collect All News": {
      "main": [[{ "node": "Groq AI ìš”ì•½", "type": "main", "index": 0 }]]
    },
    "Groq AI ìš”ì•½": {
      "main": [[{ "node": "Build Email HTML", "type": "main", "index": 0 }]]
    },
    "Build Email HTML": {
      "main": [[{ "node": "Gmail ë°œì†¡", "type": "main", "index": 0 }]]
    }
  }
}